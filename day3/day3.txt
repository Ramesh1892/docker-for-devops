# ğŸ“… Docker Day 3 - Volumes, ENV Variables, CMD & Clean-up
# ğŸ‘¨â€ğŸ’» By: Ramesh Vutukuri
# ğŸ³ Focus: Hands-on with Docker Volumes, ENV usage, script-based containers, cleanup commands

# ----------------------------------------
# âœ… 1. Create a working directory
mkdir -p ~/docker-practice/day3
cd ~/docker-practice/day3

# âœ… 2. Run nginx with a volume
docker run -d -p 8080:80 -v mydata:/usr/share/nginx/html nginx
# â¤ Serves Nginx site on localhost:8080
# â¤ Uses named volume 'mydata' for persistent content

# âœ… 3. Access and modify volume content
docker ps                            # Get container ID
docker exec -it <container_id> bash
cd /usr/share/nginx/html
echo "Hello from Docker Volume" > index.html
exit

# âœ… 4. Create script to test ENV variable
nano env-test.sh
# â¤ Content:
# #!/bin/sh
# echo "Hello, $USERNAME"

chmod +x env-test.sh

# âœ… 5. Dockerfile using ENV and CMD
nano Dockerfile
# â¤ Content:
# FROM alpine
# COPY env-test.sh /env-test.sh
# RUN chmod +x /env-test.sh
# ENV USERNAME=Ramesh
# CMD ["/env-test.sh"]

# âœ… 6. Build image
docker build -t env-test .

# âœ… 7. Run the image
docker run env-test
# â¤ Expected Output: Hello, Ramesh

# âœ… 8. View output logs (if container exits quickly)
docker ps -a
docker logs <container_id>

# âœ… 9. (Optional) Keep container running for debug
# â¤ Add 'sleep 60' in script after echo

# ----------------------------------------
# ğŸ§¹ Docker Cleanup Commands

# âœ… Stop all running containers
docker stop $(docker ps -q)

# âœ… Remove all containers
docker rm $(docker ps -aq)

# âœ… Remove all images
docker rmi $(docker images -q)

# âœ… Complete system cleanup (with volumes)
docker system prune -a --volumes
# âš ï¸ Use carefully: deletes all containers, images, volumes, cache

# âœ… Show current usage before pruning
docker system df

# ----------------------------------------
# ğŸ’¡ Interview Tips:
# - Volumes are used to store data across container restarts (e.g., MySQL, Jenkins configs)
# - ENV and CMD allow you to customize behavior and startup logic
# - Script-based containers are common for CI jobs and automation
# - Cleanup skills are essential in resource-constrained or CI environments

# âœ… Status: Docker Day 3 Completed
# ğŸ“ Saved as: ~/docker-practice/day3.txt

